<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>7-Day Weather Forecast</title>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"
        integrity="sha512-dU+4k+/vqzKHxvGiq3F6N4Y2ThlHqzTT1o7q1BPbD0D8dXxEb++ZUy1iNBDUXo3BbC2bSxejvBMFxIMExGhFw=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />


    <!-- CSS -->
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/hero.css">
    <link rel="stylesheet" href="css/button.css">

    <!-- Fonts & Icons -->
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;700&display=swap"
        rel="stylesheet">
    <script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>

    <!-- ‚úÖ Don't load Google Maps API here - we'll load it dynamically -->
</head>

<body>
    <!-- =========================
         HERO SECTION
         ========================= -->
    <header class="hero" id="hero">
        <div class="hero-content">
            <h1 class="hero-title">European Weather Explorer</h1>
            <p class="hero-sub">Plan your next trip with real-time 7-day forecasts</p>

            <div class="controls">
                <select id="citySelect">
                    <option disabled selected>Select a City</option>
                    <option value="48.85,2.35" data-bg="paris" data-name="Paris" data-flag="üá´üá∑">Paris</option>
                    <option value="51.51,-0.13" data-bg="london" data-name="London" data-flag="üá¨üáß">London</option>
                    <option value="50.85,4.35" data-bg="brussels" data-name="Brussels" data-flag="üáßüá™">Brussels
                    </option>
                    <option value="52.37,4.90" data-bg="amsterdam" data-name="Amsterdam" data-flag="üá≥üá±">Amsterdam
                    </option>
                    <option value="46.20,6.15" data-bg="geneva" data-name="Geneva" data-flag="üá®üá≠">Geneva</option>
                    <option value="52.52,13.40" data-bg="berlin" data-name="Berlin" data-flag="üá©üá™">Berlin</option>
                    <option value="48.21,16.37" data-bg="vienna" data-name="Vienna" data-flag="üá¶üáπ">Vienna</option>
                    <option value="50.08,14.44" data-bg="prague" data-name="Prague" data-flag="üá®üáø">Prague</option>
                    <option value="47.50,19.04" data-bg="budapest" data-name="Budapest" data-flag="üá≠üá∫">Budapest
                    </option>
                    <option value="52.23,21.01" data-bg="warsaw" data-name="Warsaw" data-flag="üáµüá±">Warsaw</option>
                    <option value="41.89,12.49" data-bg="rome" data-name="Rome" data-flag="üáÆüáπ">Rome</option>
                    <option value="40.41,-3.70" data-bg="madrid" data-name="Madrid" data-flag="üá™üá∏">Madrid</option>
                    <option value="37.98,23.72" data-bg="athens" data-name="Athens" data-flag="üá¨üá∑">Athens</option>
                    <option value="38.72,-9.14" data-bg="lisbon" data-name="Lisbon" data-flag="üáµüáπ">Lisbon</option>
                    <option value="44.43,26.10" data-bg="bucharest" data-name="Bucharest" data-flag="üá∑üá¥">Bucharest
                    </option>
                    <option value="59.33,18.06" data-bg="stockholm" data-name="Stockholm" data-flag="üá∏üá™">Stockholm
                    </option>
                    <option value="60.17,24.94" data-bg="helsinki" data-name="Helsinki" data-flag="üá´üáÆ">Helsinki
                    </option>
                    <option value="55.68,12.57" data-bg="copenhagen" data-name="Copenhagen" data-flag="üá©üá∞">Copenhagen
                    </option>
                    <option value="48.15,17.11" data-bg="bratislava" data-name="Bratislava" data-flag="üá∏üá∞">Bratislava
                    </option>
                    <option value="53.35,-6.26" data-bg="dublin" data-name="Dublin" data-flag="üáÆüá™">Dublin</option>
                </select>
                <button id="getForecastBtn" class="btn btn-gold">Get Forecast</button>
            </div>
        </div>
    </header>

    <!-- =========================
         BUTTON COMPONENT EXAMPLES
         
<
<button class="btn btn-gold">Get Forecast</button>
<button class="btn btn-gold loading">Get Forecast</button>
<button class="btn btn-gold" disabled>Get Forecast</button>
<button class="btn btn-secondary">Cancel</button>
<button class="btn btn-gold btn-sm">Save</button>
=========================
     LOADING OVERLAY
     ========================= -->
    <div id="loadingOverlay">
        <div class="loading-text">Loading map and forecast...</div>

        <!-- =========================
     MAIN CONTENT
     ========================= -->
        <main>
            <section id="forecastSection" class="forecast-section hidden">
                <h2 id="forecastHeading" class="forecast-heading">
                    <span id="forecastCityIcon">üåç</span>
                    <span id="forecastCityName" class="forecast-city-name">Select a City</span>
                </h2>

                <div id="weatherGrid" class="forecast-grid"></div>

                <!-- Google Map -->
                <div id="map" class="map-container">
                    <gmp-map center="48.85,2.35" zoom="4" map-id="midnight-gold-map">
                        <gmp-advanced-marker id="marker" position="48.85,2.35"></gmp-advanced-marker>
                    </gmp-map>
                </div>
            </section>
        </main>



        <!-- =========================
     FOOTER (Midnight + Gold)
     ========================= -->
        <footer class="footer">
            <div class="footer-inner">
                <p class="footer-text">¬© 2025 Long Hoa Chung | European Weather Explorer</p>

                <div class="footer-links">
                    <a href="https://github.com/longchung90" target="_blank" aria-label="GitHub">
                        <i class="fab fa-github"></i>
                    </a>
                    <a href="https://www.linkedin.com/in/long-hoa-chung/" target="_blank" aria-label="LinkedIn">
                        <i class="fab fa-linkedin"></i>
                    </a>
                    <a href="https://www.coursera.org/learner/longchung/" target="_blank" aria-label="Coursera">
                        <i class="fas fa-graduation-cap"></i>
                    </a>
                    <a href="https://lcportfolio.org" target="_blank" aria-label="Portfolio">
                        <i class="fas fa-globe"></i>
                    </a>
                </div>
            </div>
        </footer>


        -- ‚úÖ Load configuration and Google Maps API dynamically -->
        <script>
            window.googleMapsLoaded = false;
            window.initGoogleMaps = function () {
                window.googleMapsLoaded = true;
                console.log('üó∫Ô∏è Google Maps API loaded successfully');

                const overlay = document.getElementById('loadingOverlay');
                if (overlay) {
                    overlay.classList.add('hidden');
                    setTimeout(() => overlay.remove(), 800);
                }

                if (typeof initializeApp === 'function') {
                    initializeApp();
                }
            };
        </script>

        <script>
            async function loadApp() {
                try {
                    const response = await fetch('/api/config');
                    const config = await response.json();

                    const mapsScript = document.createElement('script');
                    mapsScript.src = `https://maps.googleapis.com/maps/api/js?key=${config.googleMapsApiKey}&libraries=maps,marker&v=beta&callback=initGoogleMaps`;
                    mapsScript.async = true;
                    mapsScript.defer = true;
                    document.head.appendChild(mapsScript);

                    const appScript = document.createElement('script');
                    appScript.src = 'scripts/script.js';
                    document.body.appendChild(appScript);
                } catch (error) {
                    console.error('Failed to load app:', error);
                    const appScript = document.createElement('script');
                    appScript.src = 'scripts/script.js';
                    document.body.appendChild(appScript);
                }
            }

            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', loadApp);
            } else {
                loadApp();
            }
        </script>